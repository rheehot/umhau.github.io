<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?">


    <link rel="stylesheet" type="text/css" href="/assets/css/styles.css">
    <meta name="viewport" content="width=device-width">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="/js/infinite-jekyll.js"></script>

  </head>
  <body>
    <box class="wrapper">
      <header>
        <a href="http://localhost:4000"> <h1>*nixing around</h1> </a>
        <p>A programmer's journal of complicated projects.</p>
        <p class="view"><a href="">github</a> | <a href="http://localhost:4000/about">about</a> | <a href="http://localhost:4000/explore">explore</a></p>

        <p>testing</p>

      </header>
      <section>

      <div class="post">

    <header class="post-header">
        
    <h1 class="post-title">Installing Kaldi and Kaldi-Gstreamer-server on Ubuntu 16.04</h1>
    <p 
        class="post-meta">Jul 26, 2016 • <a  href="/2016/07/26/installing-kaldi-and-kaldi-gstreamer/">permalink</a>
        <i>  • Linux • make • kaldi • speech to text • Ubuntu 16.04 • DNN • alumae</i> 
    </p>
    </header>

    <article class="post-content">
    <div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: left;">Notes on the process of installing Kaldi and Kaldi-GStreamer-server&nbsp;on Ubuntu 16.04 LTS. &nbsp;These were modified somewhat, since this is retroactively documented for my own benefit.</div><br />Kaldi is a state-of-the-art speech transcription engine, geared towards researchers and people who already know what they're doing. &nbsp;I'm just trying to set it up.<br /><br />Decide where to put Kaldi and make that your new working directory.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: consolas, menlo, monaco, lucida console, liberation mono, dejavu sans mono, bitstream vera sans mono, courier new, monospace, sans-serif;">mkdir ~/tools/<br />cd tools</span></pre>Clone Kaldi from github.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">git clone https://github.com/kaldi-asr/kaldi.git</span></pre><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">cd</span>&nbsp;into this new location.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">cd ./kaldi-master/tools</span></pre>Check for any dependencies. &nbsp;There were a few things I needed to add to my Ubuntu installation; don't remember what they were. &nbsp;Do whatever this output instructs.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">extras/check_dependencies.sh</span></pre>Now comes the actual installation.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">make<br />cd ../src<br />./configure --shared<br />make depend<br />make</span></pre>Run this next to install the online extensions. <br /><pre style="background-color: #eff0f1; border: 0px; color: #111111; font-family: consolas, menlo, monaco, &quot;lucida console&quot;, &quot;liberation mono&quot;, &quot;dejavu sans mono&quot;, &quot;bitstream vera sans mono&quot;, &quot;courier new&quot;, monospace, sans-serif; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;">make ext</pre>Note: if you have more than one core in your machine, you can run&nbsp;<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">make -j 4&nbsp;</span>to do&nbsp;<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">make</span>&nbsp;in parallel.<br /><br /><b>Congratulations. &nbsp;Kaldi is installed. &nbsp;Installing&nbsp;Kaldi-GStreamer-server:</b><br /><br />Before actually installing the kaldi-gstreamer-server, there's a few more things to do with kaldi itself.<br />Compile the Gstreamer plugin. &nbsp;First, install dependencies. Note they are older versions of the packages. &nbsp;Make sure you get the right version. &nbsp;On Ubuntu/Debian, run:<br /><br /><pre style="background-color: #eff0f1; border: 0px; color: #111111; font-family: consolas, menlo, monaco, &quot;lucida console&quot;, &quot;liberation mono&quot;, &quot;dejavu sans mono&quot;, &quot;bitstream vera sans mono&quot;, &quot;courier new&quot;, monospace, sans-serif; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;">sudo apt-get install libgstreamer1.0-dev gstreamer1.0-plugins-good gstreamer1.0-tools gstreamer1.0-pulseaudio</pre>Kaldi-Gstreamer-server requires the gstreamer plugin to be compiled (makes sense).<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">cd ~/tools/kaldi-master/src/gst-plugin/<br />make depend<br />make</span></pre>This folder (gst-plugin) should now contain the file&nbsp;libgstkaldi.so which contains the Gstreamer plugin.<br /><br />Now it's time to install the kaldi-gstreamer-server package. &nbsp;First, more dependencies.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">sudo apt-get install pip python-yaml python-gi<br />pip install tornado ws4py==0.3.2 pyyaml</span></pre>Note: You might need to run pip as sudo. &nbsp;e.g.&nbsp;<span style="background-color: #eff0f1; color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">sudo pip install tornado</span>, above.<br />Note: I couldn't figure out which YAML package to install, so I used both. &nbsp;At least, they're both installed, and I don't remember which I actually needed. &nbsp;If I do this again, I'll try to remember to change this.<br /><br />Clone kaldi-gstreamer-server from GitHub into your tools folder.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">cd ~/tools/<br />git clone https://github.com/alumae/kaldi-gstreamer-server.git</span></pre><br /><b>This completes the installation.</b><br /><br />cd into the main folder.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">cd ./kaldi-gstreamer-server/</span></pre>Open the README file, peruse until understood.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">gedit ./readme.md</span></pre>Now you'll understand what I mean by server and worker. &nbsp;You can start the server with:<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">python kaldigstserver/master_server.py --port=8888</span></pre>Before starting a worker, make sure that the GST plugin path includes the gstreamer plugin you compiled. &nbsp;If you put everything where I recommended, this is all you have to do:<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">export GST_PLUGIN_PATH=~/tools/kaldi-master/src/gst-plugin</span></pre>Test to make sure it worked. &nbsp;If it fails, take a look at the README file again. &nbsp;This command should spit out a bunch of information. &nbsp;If it just says something like, 'not found', you did something wrong. &nbsp;I have no idea what.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">gst-inspect-1.0 onlinegmmdecodefaster</span></pre>Now you can start a worker.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">python kaldigstserver/worker.py -u ws://localhost:8888/worker/ws/speech -c sample_worker.yaml</span></pre>Example of how to use the server to transcribe text:<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; width: auto; word-wrap: normal;"><span style="color: #111111; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif;">python kaldigstserver/client.py -r 32000 ~/tools/kaldi-gstreamer-server/test/data/english_test.raw</span></pre>You can also use a Deep Neural Network (DNN) to process the data, but at time of writing the readme walkthrough was giving me errors.<br /><br /><b>That's it!</b></div>
    </article>

    <p class="extra-space"></p>
    <hr>
    <p class="extra-space"></p>

</div>





      </section>
      <footer>
        <p><small>Hosted on GitHub &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a> and <a href="https://github.com/umhau">umhau</a></small></p>
      </footer>
    </box>
    <script src="/assets/js/scale.fix.js"></script>


  



  </body>
</html>
