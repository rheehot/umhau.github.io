<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?">


    <link rel="stylesheet" type="text/css" href="/assets/css/styles.css">
    <meta name="viewport" content="width=device-width">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="/js/infinite-jekyll.js"></script>

  </head>
  <body>
    <box class="wrapper">
      <header>
        <a href=""> <h1>*nixing around</h1> </a>
        <p>A programmer's journal of complicated projects.</p>
        <p class="view"><a href="">github</a> | <a href="/about">about</a> | <a href="/explore">explore</a></p>

        <p>testing</p>

      </header>
      <section>

      <div class="post">

    <header class="post-header">
        
    <h1 class="post-title">Raspberry Pi Zero USB Audio on Raspbian Jessie (method 2)</h1>
    <p 
        class="post-meta">Nov 30, 2016 • <a  href="/2016/11/30/raspberry-pi-zero-usb-audio-on-raspbian/">permalink</a>
        <i>  • audio • Raspbian Jessie • USB • STATIC • success • ALSA • Raspberry Pi</i> 
    </p>
    </header>

    <article class="post-content">
    Well, this is the second way to skin the cat. &nbsp;Note that arecord ignores what went into the recording section of the config file specified below. &nbsp;See the execution section for actually making a record or playing something.<br /><br />Followed the instructions of OP in <a href="https://www.raspberrypi.org/forums/viewtopic.php?t=20866" target="_blank">this post</a>, more or less (as detailed below). &nbsp;Note the extra information provided by the top post at <a href="https://www.raspberrypi.org/forums/viewtopic.php?f=28&amp;t=10848&amp;start=28" target="_blank">this link</a>.<br /><br />For some reason, the space on the RPi's SD card filled up completely after following those instructions and messing with the results. &nbsp;Not even enough space to run ls on a big directory. &nbsp;Something I'd expect if I'd run arecord instead of aplay, and left it going indefinitely.<br /><br />Log into the pi.<br /><pre style="background-color: #eff0f1; border: 0px; color: #333333; font-size: 14px; margin-bottom: 1em; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;">ssh pi@raspberrypi</pre>Install a dependency (don't worry, it's small).<br /><pre style="background-color: #eff0f1; border: 0px; color: #333333; font-size: 14px; margin-bottom: 1em; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;">sudo apt-get install libasound2-plugins</pre>Edit the ALSA config file, but first backup the original.<br /><pre style="background-color: #eff0f1; border: 0px; color: #333333; font-size: 14px; margin-bottom: 1em; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;">cp ~/.asoundrc ~/.asoundrc.bak<br />sudo nano ~/.asoundrc</pre>Add the following to the file.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;"><span style="color: #333333;"><span style="font-size: 14px;">pcm.!default {<br />              type asym<br />              playback.pcm "defaultplayback"<br />              capture.pcm "defaultrec"<br />                hint{   show on<br />                   description "default play and rec koko"<br />                }<br />      }<br /><br />      pcm.defaultrec {<br />              type plug<br />              slave {<br />                  pcm "hw:1,0"<br />                  rate 48000 <br />                  channels 2<br />                  format S16_LE<br />              }<br />                hint{   show on<br />                   description "default rec koko"<br />                }<br /><br />      }<br /><br />  pcm.defaultplayback{<br />          type rate<br />          slave.pcm mix1<br />          slave.rate 48000 <br /><br />          #Intel(R) Core(TM)2 Duo CPU     E7500  @ 2.93GHz:<br /><br />            #converter "samplerate_best"     # perfect: 16%cpu, maybe overkill<br />            #converter "samplerate_medium"   # almost perfect: 6%cpu<br />            #converter "samplerate"          # good: 4%cpu, definitely usable<br />            #converter "samplerate_linear"   # bad: 2%cpu, way better than default wine resampler<br />            #converter "samplerate_order"    # very bad: 2%cpu, like the default wine resampler<br /><br />          converter "samplerate"<br /><br />            hint{   show on<br />                   description "default play koko"<br />            }<br />  }<br /><br />    pcm.mix1 {<br />            type dmix<br />            ipc_key 1024<br />            slave {<br />                pcm "hw:1,0"<br />                rate 48000<br />                periods 128<br />                period_time 0<br />                period_size 1024 # must be power of 2<br />                buffer_size 65536<br /><br />            }<br />    }</span></span></pre><h4>Execution</h4>To play a file (of the proper format):<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;"><span style="color: #333333;"><span style="font-size: 14px;">aplay file.wav</span></span></pre>To record a file:<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;"><span style="color: #333333;"><span style="font-size: 14px;">arecord -f cd file.wav</span></span></pre>Read the aplay or arecord manual to see what's up with the -f cd thing. &nbsp;Essentially, it's specifying the format the audio should be in.<br /><pre style="background-color: #eff0f1; border: 0px; margin-bottom: 1em; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;"><span style="color: #333333;"><span style="font-size: 14px;">man arecord</span></span></pre><br />
    </article>

    <p class="extra-space"></p>
    <hr>
    <p class="extra-space"></p>

</div>





      </section>
      <footer>
        <p><small>Hosted on GitHub &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a> and <a href="https://github.com/umhau">umhau</a></small></p>
      </footer>
    </box>
    <script src="/assets/js/scale.fix.js"></script>


  



  </body>
</html>
