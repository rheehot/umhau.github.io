---
layout: post
title: Basic filesharing server on OpenBSD (updated for 6.0)
date: '2016-11-09T16:54:00.003-05:00'
author: umhau
tags:
- file server
- OpenBSD
- OpenBSD 5.9
modified_time: '2017-01-17T10:33:33.262-05:00'
blogger_id: tag:blogger.com,1999:blog-2584289275272726799.post-2426656227573479109
blogger_orig_url: http://nixingaround.blogspot.com/2016/11/basic-filesharing-server-on-openbsd.html
---

For the record. &nbsp;I assume that the other OpenBSD pages on this site have already been implemented.<br /><br />Install samba:<br /><pre style="background-color: #eff0f1; border: 0px; color: #333333; font-size: 14px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;">pkg_add samba</pre>Create a folder to use as a shared location. &nbsp;According to the official docs, that's what /srv is for. &nbsp;Since I use this a lot, I'm not going to bother with any further file structure.<br /><pre style="background-color: #eff0f1; border: 0px; color: #333333; font-size: 14px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;">mkdir -p /srv/<br />chmod 777 /srv/</pre>Modify the samba configuration file for a basic all-permissive shared folder. &nbsp;My threat model assumes that if someone is connected to the network, they're friendly. &nbsp;Since there's several Win7 computers on the network, I had to get around the authentication requests.<br /><br />Cut &amp; paste stuff doesn't really work on the command line, so here's what needs to be added at the bottom of the /etc/samba/smb.conf. <a href="http://serverfault.com/questions/575394/samba-public-share-windows-keeps-asking-for-password/691141#691141" target="_blank">src</a>.<br /><pre style="background-color: #eff0f1; border: 0px; color: #333333; font-size: 14px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;">nano /etc/samba/smb.conf</pre><pre style="background-color: #eff0f1; border: 0px; color: #333333; font-size: 14px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;">[SRV]<br />    path = /srv/<br />    public = yes<br />    only guest = yes<br />    writable = yes<br />    printable = no<br />    guest ok = yes<br />    read only = no<br />    map to guest = bad user</pre>After finishing the smb.conf edits, use the rc.conf.local file to start the samba share with the machine. &nbsp;You can use the echo command to make the adjustments. &nbsp;<b>Note:</b>&nbsp;rc.conf.local doesn't actually exist in the default OpenBSD...but it is acknowledged. &nbsp;<a href="http://www.binorassocies.com/en/blogs/2016/02/samba-server.html" target="_blank">src</a>.<br /><pre style="background-color: #eff0f1; border: 0px; color: #333333; font-size: 14px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;">echo '<br />smbd_flags="-D"<br />nmbd_flags="-D"<br />' &gt;&gt; /etc/rc.conf.local</pre><pre style="background-color: #eff0f1; border: 0px; color: #333333; font-size: 14px; margin-bottom: 1em; max-height: 600px; overflow: auto; padding: 5px; text-align: justify; width: auto; word-wrap: normal;">rcctl enable samba<br />rcctl restart samba</pre>That should do it.<br /><br />